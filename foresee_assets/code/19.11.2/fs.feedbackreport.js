/***************************************
 * @preserve
 * Copyright (c) 2019 Verint Systems, Inc. All rights reserved.
 * ForeSee Web SDK: Feedback Reporting UI
 * Version: 19.11.2
 * Built: November 07, 2019, 12:47:06 CST
 ***************************************/
_fsDefine(["fs",_fsNormalizeUrl("$fs.utils.js"),"exports"],function(e,t,i){var n={},s=!1;var o,a,r=function(){function e(e,t){this.br=e,this.cfg=t}return e.prototype.platformOK=function(){var e=this.cfg,t=this.br;return!(e.browser_cutoff[t.browser.name]&&t.browser.actualVersion<e.browser_cutoff[t.browser.name])&&!(e.platform_cutoff[t.os.name]&&t.os.version<e.platform_cutoff[t.os.name])},e}(),c={remove:function(){this.parentNode&&this.parentNode.removeChild(this)},hasClass:function(e){return this.className.indexOf(e)>-1},addClass:function(e){this.hasClass(e)||(this.className+=" "+e)},removeClass:function(e){this.className=(this.className||"").replace(e,""),this.className=this.className.replace(/[ ]+$/g,"")},$:function(e){return this.querySelectorAll(e)},css:function(t){for(var i in t)e.hasProp(t,i)&&(this.style[i]=t[i])}},d=function(t){if("string"==typeof t&&-1==t.indexOf("<"))return document.querySelectorAll(t);if("string"==typeof t){var i=document.createElement("div");i.innerHTML=t,t=i.firstChild}for(var n in c)e.hasProp(c,n)&&(t[n]=c[n]);return t},f=function(){function i(e,i){var s=this;this.cfg=e;var o=this,a="acsFeedbackResultsCounter";this.btncfg=e,this.badgeClicked=new t.FSEvent,this.br=i,this.animationMove=4,e.counter&&(this.counter=0,sessionStorage.getItem(a)&&(this.counter=Math.round(parseFloat(sessionStorage.getItem(a))),this.counter=isNaN(this.counter)?0:this.counter),this.btncfg.counter=this.counter,this.btncfg.counterLocale=e.counter.toLocaleString()),this.btncfg.btnClass="_acs _acs"+e.fbtype+"--"+e.template+" _acs"+e.fblocation,this.btncfg.fbsize=this.cfg.fbsize||"medium",this.btncfg.btnClass="_acs _acs"+e.fbtype+"--"+e.template+" _acsbadge--"+this.btncfg.fbsize+" _acs"+e.fblocation,this.btncfg.fbcolortext=this.btncfg.fbcolortext||"#fff",this.queue=new t.Async(!0,function(){},function(){}),this.queue.enqueue(function(i){s._getBtnTemplate(i,function(i){s.btnTemplate=i;var a={btncfg:o.btncfg},r=o.btnTemplate(a);s.$el=document.createElement("div"),s.$el.innerHTML=r,s.$el=d(s.$el.querySelectorAll("div._acs")[0]),t.Bind(o.$el,"feedback:click",function(){o._unhover(),o.badgeClicked.fire(e)},!0),t.Bind(o.$el,"feedback:keypress",function(e){var i=t.getKeyCode(e);"enter"!==i&&"spacebar"!==i||(o._unhover(),o.badgeClicked.fire(o.cfg))},!0),o.cfg.fbanimate&&(t.Bind(o.$el,"feedback:mouseenter",function(){o._hover()},!0),t.Bind(o.$el,"feedback:mouseleave",function(){o._unhover()},!0)),document.body.appendChild(s.$el),n&&!n.FBALTPOSITION&&t.addClass(document.documentElement,"fsfb fsfb-relbody"),s.init()})})}var s=i.prototype;return s._getBtnTemplate=function(i,n){var s=e.makeURI("$templates/feedback/"+(this.template||"default")+"/badge.html");new t.TemplateFetcher({success:function(e){if(i&&i.resolve(),n)return n(e)}}).get(s)},s._hover=function(){this.cfg.fbanimate&&this.$el.addClass("_acsHover")},s._unhover=function(){this.cfg.fbanimate&&this.$el.removeClass("_acsHover")},s.init=function(e){var t=this.$el.$("._acsBadgeLabel");if(this.$el.css({visibility:"hidden"}),t&&t.length>0&&(this._unhover(),this.$el.addClass("_acsAnimate"),"vertical"==this.cfg.fbdirection&&(this.cfg.fblocation.indexOf("right")>-1?this.$el.addClass("_acsVertical_right"):this.$el.addClass("_acsVertical_left")),this.cfg.fbfixed&&this.$el.addClass("_acsFixed")),this.$el.css({visibility:"visible"}),this.$el.css({opacity:1}),e)return e()},s.setCounter=function(e){void 0===e&&(e=0),d(this.$el.$("._acsCounterInner")[0]).innerHTML=Math.round(e).toLocaleString(),sessionStorage.setItem("acsFeedbackResultsCounter",e)},s.disableCounter=function(){},s.enableCounter=function(){this.$el&&(this.$el.$("._acsCounterInner")[0].innerHTML="0",d(this.$el.$("._acsCounterInner")[0]).css({background:"#F87473"}))},s.remove=function(){this.$el.parentNode.removeChild(this.$el)},i}(),l=function(){function i(i,n){this.br=i,this.ready=new t.FSEvent,this.didInitialize=!1,this.didBuildUI=!1,this.cfg={counter:!0,label:"ForeSee",fbtype:"report",fblocation:"topright",template:"default",icon:"aspark100.png"};var s=e.getProductConfig("feedback");void 0===n&&s.instances[0]&&s.instances[0].reporturi?this.cfg.reporturi=s.instances[0].reporturi:this.cfg.reporturi=n.reporturi}var n=i.prototype;return n.initialize=function(){var i=this;t.loadCSS(e.makeURI("$templates/feedback/default/main.css"),function(e){i.didInitialize=!0,i.ready.fire()},null,this.br)},n.run=function(){this.didBuildUI||(this.wasLoggedInEver=!1,this._addiFrame(),this._addReportBadge(),t.Bind(window,"feedback:message",this.onMessageReceived.bind(this)),this.didBuildUI=!0)},n.onMessageReceived=function(e){var t=e.data;t.location?sessionStorage.setItem("acsFeedbackRoute",t.location):!0===t.isLoggedIn?(this.badge.enableCounter(),this.wasLoggedInEver=!0,this.frame.contentWindow.postMessage({wPageUrl:window.location.toString()},"*")):!1===t.isLoggedIn?("true"===sessionStorage.getItem("acsReportFrameVisible")?this.showiFrame():(this.removeReport(),sessionStorage.setItem("acsFeedbackLoaded","false")),this.badge.disableCounter()):void 0!==t.feedbackResponses&&this.badge.setCounter(t.feedbackResponses)},n.removeReport=function(){this.container.removeClass("acsVisibleFrame"),sessionStorage.setItem("acsReportFrameVisible","false")},n._addReportBadge=function(){var e=this;this.badge||(this.badge=new f(this.cfg,this.br),this.badge.badgeClicked.subscribe(function(){e.showiFrame()}))},n.showiFrame=function(){this.didBuildUI&&(this.container.addClass("acsVisibleFrame"),sessionStorage.setItem("acsReportFrameVisible","true"))},n._addiFrame=function(){var e=this,i=document;if(!this.didBuildUI){this.container=d('<div class="acsFrameContainer--default"></div>'),"true"==sessionStorage.getItem("acsReportFrameVisible")&&this.container.addClass("acsVisibleFrame"),this.closeBtn=d('<a href="#" class="acsReportCloseBtn" aria-label="Close"><span class="material-icons">&#xE5CD;</span></a>'),t.Bind(this.closeBtn,"feedback:click",function(t){return t.preventDefault(),e.removeReport(t),!1}),this.frame=d('<iframe class="acsReportFrame" frameBorder="0" allowfullscreen></iframe>'),this.frame.src=this.cfg.reporturi||sessionStorage.getItem("acsFeedbackRoute"),t.Bind(this.frame,"feedback:load",function(){var t={wIsLoggedIn:"GET"};e.frame.contentWindow&&e.frame.contentWindow.postMessage(t,"*")}),this.container.appendChild(this.frame),this.container.appendChild(this.closeBtn),i.body.appendChild(this.container);var n=function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1};t.Bind(this.container,"feedback:mouseenter",function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",n,!1),window.onmousewheel=document.onmousewheel=n}),t.Bind(this.container,"feedback:mouseleave",function(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",n,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null})}},i}(),u=function(i){var n=window._acsURL||window.location.toString().split("#acscommand=feedbackreport").join("");function s(e){if(!Array.isArray(e))return!1;for(var i=0;i<e.length;i++)if(t.testAgainstSearch(e[i],n))return!0;return!1}return n=e.toLowerCase(n),(!i.whitelistActive||s(i.whitelistData))&&(!i.blacklistActive||!s(i.blacklistData))};function h(){var i=e.getProductConfig("feedback"),n=new t.Browser,s=i.instances;s&&n.ready.subscribe(function(){if(new r(n,i).platformOK()){for(var e,t=0;t<s.length;t++){var o=s[t];if(o.topics&&o.topics.length)for(var a=0;a<o.topics.length;a++)if(u(o.topics[a])&&!o.disabled){e=o;break}if(e)break}var c=new l(n,e);c.ready.subscribe(function(){c.run()}),c.initialize()}},!0,!0)}return o=e.getProductConfig("feedback"),a=e.ext({browser_cutoff:{Edge:1,IE:11,IEMobile:10,Safari:5.2,Firefox:30,Chrome:30,Opera:1e3},platform_cutoff:{Android:5,Winphone:7.4,iPod:9,iPhone:9,iPad:9}},o),e.ext(o,a),i.startup=function(){(function(){var t=e.getProductConfig("fbmods")||{},i=e.toLowerCase(window.location.href.toString());if((t.noPositionRelativeBody||i.indexOf("buildabear.c")>-1||i.indexOf("bab-dev-store.sparkred.")>-1||i.indexOf("humana.c")>-1||i.indexOf(".dteenergy.c")>-1||i.indexOf(".mcdonalds.")>-1)&&(n.FBALTPOSITION=!0),(t.overflowScroll||i.indexOf(".peco.c")>-1||i.indexOf(".bge.com")>-1||i.indexOf(".comed.com")>-1)&&(n.FBALTOVERFLOW=!0),(t.skipIFrames||i.indexOf("argos.co")>-1)&&window!==window.top)return!1;if(t.temporaryCssHack&&!s){s=!0;var o=document.createElement("style");o.innerHTML="\n/* ForSee Feedback CSS Styles */\n"+t.temporaryCssHack,document.head.append(o)}return!0})()&&e.domReady(h)},i});
