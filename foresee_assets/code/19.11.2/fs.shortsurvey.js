/***************************************
 * @preserve
 * Copyright (c) 2019 Verint Systems, Inc. All rights reserved.
 * ForeSee Web SDK: Short Survey Presenter
 * Version: 19.11.2
 * Built: November 07, 2019, 12:47:06 CST
 ***************************************/
_fsDefine(["fs",_fsNormalizeUrl("$fs.utils.js"),"exports"],function(t,e,i){var s=function(){function t(t){this.el=document.createElement("iframe"),this.updateStyle(),this.el.setAttribute("srcdoc",t);var i=e.getBrowserInstance();if("Edge"===i.browser.name||i.isIE){var s="javascript: window.frameElement.getAttribute('srcdoc');";this.el.contentWindow&&(this.el.contentWindow.location=s),this.el.setAttribute("src",s)}return this}var i=t.prototype;return i.updateSize=function(t){var e=t.width,i=t.height;if(this.el)return null!=e&&(this.el.width=e),null!=i&&(this.el.height=i),this},i.updateStyle=function(t){var e=this;return void 0===t&&(t={}),this.el.style.background="transparent",this.el.style.border=0,this.el.style.position="fixed",t.position&&(/^top/.test(t.position)?this.el.style.top=0:/^bottom/.test(t.position)&&(this.el.style.bottom=0),/left$/.test(t.position)?(this.el.style.left="-200px",this.el.style.transition="left .66s ease-out",setTimeout(function(){return e.el.style.left="0px"},0)):/right$/.test(t.position)&&(this.el.style.right="-200px",this.el.style.transition="right .66s ease-out",setTimeout(function(){return e.el.style.right="0px"},0))),this.el.style.zIndex=t.zIndex||99999999,this},t}();return function(){function i(t,i,s,n,r,o){this.stg=r,this.config=t,this.surveydef=i,this.display=s,this.cpps=n,this.locale=n.get("locale")||"en",this.shortSurveyConfig=s&&s.shortSurvey||{},this.surveyMID=o.getMeasureId();var a=this.getPageView(),h=this.shortSurveyConfig.midOverride,u=null;switch(this.shortSurveyConfig.paginationType){case"single":case"split":u=this.shortSurveyConfig.paginationType;break;case"random":u=[null,"split","single"][~~(3*Math.random())]}this.surveyUrl=o.getShortSurveyUrl({pageView:a,paginationType:u,midOverride:h}),this.surveyOrigin=o.getShortSurveyOrigin(),this.declined=new e.FSEvent,this.abandoned=new e.FSEvent,this.accepted=new e.FSEvent,this.completed=new e.FSEvent}var n=i.prototype;return n.loadResources=function(t){var i=this;(new e.AjaxTransport).send({url:this.surveyUrl,method:"GET",success:function(e){i.html=i.fixURLs(e).replace(/(<head.*?>)/,"$1\n            <style>\n              main.fsrSurvey__content > section.fsrPage__context--container {\n                animation: none !important;\n              }\n            </style>"),t.fire()},failure:function(t,e){}})},n.present=function(){var t=this;if(this.iframe=new s(this.html),this.iframe.updateSize({width:480,height:300}),this.shortSurveyConfig.style&&this.iframe.updateStyle(this.shortSurveyConfig.style),document.body.appendChild(this.iframe.el),setTimeout(function(){t.iframe.el.contentDocument.addEventListener("click",function(){t.stg.set(t.surveyMID+"li",Date.now()),clearTimeout(t.inactivityTimer)})},0),!this.stg.get(this.surveyMID+"li")){var e=this.shortSurveyConfig.idleTimeBeforeAbandon||0;e&&(this.inactivityTimer=setTimeout(function(){return t.abandon()},e))}var i=this.stg.get(this.surveyMID+"pc")||0;i++,this.stg.set(this.surveyMID+"pc",i),this.setupAPI()},n.fixURLs=function(t){return t.replace(/"\/static\//g,'"'+this.surveyOrigin+"/static/")},n.abandon=function(){this.abandoned.fire(),this.dispose()},n.getPageView=function(){return this.stg.get(this.surveyMID+"pv")},n.setupAPI=function(){var e=this;t.API.expose("Survey",{close:function(){e.dispose()},decline:function(){e.declined.fire("INVITE_DECLINED_BTN"),e.dispose()},abandon:function(){return e.abandon()},complete:function(){e.completed.fire(!0),e.dispose()},accept:function(){e.accepted.fire(e.display.inviteType)},getPageView:function(){return e.getPageView()},updateSize:function(t,i){e.iframe.updateSize({width:t,height:i})}})},n.dispose=function(){document.body.removeChild(this.iframe.el),this.iframe=null},i}()});
